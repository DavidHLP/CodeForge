<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.david.mapper.ProblemMapper">

    <resultMap id="ProblemResultMap" type="com.david.problem.Problem" autoMapping="true">
        <id property="id" column="id"/>
        <result property="tags" column="tags" javaType="java.util.List"
                typeHandler="com.baomidou.mybatisplus.extension.handlers.JacksonTypeHandler"/>
    </resultMap>

    <select id="pageProblems" resultMap="ProblemResultMap">
        SELECT
        *
        FROM
        problems
        <where>
            <if test="keyword != null and keyword != ''">
                AND title LIKE CONCAT('%', #{keyword}, '%')
            </if>
            <if test="difficulty != null">
                AND difficulty = #{difficulty}
            </if>
            <if test="category != null">
                AND category = #{category}
            </if>
            <if test="isVisible != null">
                AND is_visible = #{isVisible}
            </if>
        </where>
        ORDER BY id ASC
    </select>
    <select id="selectSolutionFunctionName" resultType="String">
        select distinct solution_function_name
        from problems
                 left join test_cases_outputs on problems.id = test_cases_outputs.problem_id
        where problem_id = #{problemId}
    </select>
    <select id="selectCompareDescription" resultType="com.david.submission.dto.CompareDescription">
        select solution_function_name, difficulty
        from problems
        where id = #{problemId}
    </select>
</mapper>
